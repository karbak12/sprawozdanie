---
title: "Sprawozdanie na temat nierówności dochodów w Europie."
author: 
  - name: "Karolina Bakalarz"
    index: "276059"
  - name: "Amelia Bieda"
    index: "275973"
format: pdf
editor: visual
lang: pl

---

# Wstęp

## Cel sprawozdania

Celem niniejszego sprawozdania jest analiza trzech kluczowych zagadnień związanych z poziomem zamożności i nierówności dochodowych w Europie.

Przede wszystkim, badanie ma na celu zrozumienie, w jaki sposób położenie geograficzne krajów w Europie wpływa na ich poziom zamożności, mierzony poprzez PKB.

Zbadamy również wpływ przynależności do Unii Europejskiej na gospodarki krajów, z naciskiem na ewentualne zmiany w poziomie PKB po akcesji do UE.

Ostatecznie sprawdzimy nierówności dochodowe między poszczególnymi państwami europejskimi, poprzez wyniki wskaźnika Gini'ego.

Taka analiza pozwoli nam lepiej zrozumieć sytuację ekonomiczną w Europie, w kontekście zamożności i rozwoju gospodarczego.

## Źródło danych

Dane wykorzystane w analizie pochodzą z najnowszej wersji World Income Inequality Database (WIID), opublikowanej 28 listopada 2023 roku. WIID to największe dostępne źródło danych o nierównościach dochodowych na świecie, udostępniane bezpłatnie na otwartej licencji.

Źródła danych obejmują raporty krajowe i regionalne publikowane przez instytucje statystyczne i rządowe, międzynarodowe bazy danych, takie jak Światowy Bank, OECD i Eurostat, oraz ankiety i badania gospodarstw domowych dotyczące dochodów, konsumpcji i nierówności.

Wszystkie dane są standaryzowane, aby umożliwić porównania między krajami i okresami, co pozwala WIID dostarczać spójne serie czasowe, wskaźniki nierówności oraz pełne rozkłady dochodów na poziomie krajowym i globalnym.

# Opis danych

-   Kraj - określa, do którego europejskiego państwa przynależą dane w badanym wierszu.

-   Skrót - trzycyfrowy kod kraju w formacie ISO 3166-1.

-   G - wskaźnik Giniego, czyli miara koncentracji rozkładu zmiennej losowej, w tym przypadku nierówności dochodowej, określona na przedziale 0-100 (w procentach). Wartość zerowa wspołczynnika wskazuje na pełną równomierność rozkładu.

-   Zasoby - szczegółowy podział zasobów

    -   IDK CZY TO UWZGLĘDNIMY, to narazie bardziej dla nas, w oryginalnych danych mamy podział: "Consumption", "Income, net", "Income, net/gross", "Earnings, gross", "Income, gross", "Market income", "Taxable income, gross", "Taxable income, net", "Earnings, net", "Monetary income, net", "Monetary income, gross", "Factor income", "Monetary income, net (excluding property income)", "Earnings", "Taxable income, excluding property income", "Taxable income, gross (including deductions)".

-   Skala - szczegółowa skala normalizacji(?). ?przeskalowane dochody?

    -   "Per capita", "OECD-modified", "Equivalized", "No adjustment", "Square root", "OECD", NA, "National scale", "1977 McClements scale".

-   Region - grupowanie subregionalne, czyli podział na Europę północną, południową, zachodnią i wschodnią (oparte na geoschemacie Organizacji Narodów Zjednoczonych).

-   G - wskaźnik Giniego, czyli miara koncentracji rozkładu zmiennej losowej, w tym przypadku nierówności dochodowej.

-   UE - status należenia do Unii Europejskiej dla odpowiedniego roku.

-   PKB - wartość produktu krajowego brutto (w dolarach amerykańskich?).

## Wczytanie i przygotowanie danych

-   nadanie odpowiednich nazw zmiennych,

-   zadbanie o odpowiednie typy kolumn,

-   czyszczenie wartości, jeśli zachodzi taka konieczność,

-   dyskusję lub obsługę braków danych;

Z bazy danych WIID będziemy w niniejszym raporcie skupiać się na analizie danych z Europy. Z tego powodu, pozostawiłyśmy wartości dotyczące jedynie analizowanego przez nas kontynentu. Zweryfikowałyśmy typy danych dla każdej kolumny, następnie, dla lepszej czytelności, nazwy kolumn zostały zmienione. Wiersze z brakami danych ("NA") usunęłyśmy, aby uniknąć nieciągłości. W krajach rozwiniętych dane o dochodach są powszechniej stosowane w badaniach, niż dane o wydatkach konsumpcyjnych, stąd zdecydowałyśmy się usunąć zmienną "Consumption" w kategorii "Zasoby".

Po przygotowaniu otrzymałyśmy zbiór około 13 tysięcy wartości w 9 kolumnach. Prezentuje się on następująco:

```{r, echo=FALSE, massage=FALSE, warning=FALSE}

# Ładowanie niezbędnych pakietów

library(tidyverse) # Pakiet do wczytania i czyszczenia danych
library(e1071)  # Pakiet dla skośności i kurtozy
library(scales)  # Pakiet dla lepszego formatowania liczb
library(rnaturalearth)
library(sf)
library(dplyr)
library(ggplot2)
library(readr)
library(stringr)
```

```{r, echo=FALSE, massage=FALSE}
# Oczyszczanie danych

data <- read_csv2("dane_WIID_2023.csv", show_col_types = FALSE) %>%
  filter(region_un == "Europe") %>%
  select(country, c3, year, gini, resource_detailed, scale_detailed, region_un_sub, eu, gdp) %>%
  mutate(across(c(country, c3, resource_detailed, scale_detailed, region_un_sub, eu), as.factor)) %>%
  mutate(across(c(year, gini), as.numeric)) %>%
  mutate(
    gdp = str_remove_all(gdp, " "),
    gdp = as.numeric(gdp)
  ) %>%
  filter(resource_detailed != "Consumption") %>%
  filter(if_all(everything(), ~ !is.na(.))) %>%
  filter(scale_detailed == "Per capita") %>%
  rename(
    Kraj = country,
    Skrót = c3,
    Rok = year,
    G = gini,
    Zasoby = resource_detailed,
    Skala = scale_detailed,
    Region = region_un_sub,
    UE = eu,
    PKB = gdp
  )
head(data)
```

```{r, echo=FALSE, massage=FALSE}
# Ładowanie niezbędnych pakietów
library(tidyverse)
library(e1071)  # Pakiet dla skośności i kurtozy
library(scales)  # Pakiet dla lepszego formatowania liczb

# Obliczanie statystyk opisowych

statystyki_all <- data %>%
  summarise(
    # Statystyki dla PKB
    Średnia_PKB = mean(PKB, na.rm = TRUE),
    Mediana_PKB = median(PKB, na.rm = TRUE),
    Odchylenie_standardowe_PKB = sd(PKB, na.rm = TRUE),
    Min_PKB = min(PKB, na.rm = TRUE),
    Max_PKB = max(PKB, na.rm = TRUE),
    Kwartyla_1_PKB = quantile(PKB, 0.25, na.rm = TRUE),
    Kwartyla_3_PKB = quantile(PKB, 0.75, na.rm = TRUE),
    IQR_PKB = IQR(PKB, na.rm = TRUE),
    Skala_PKB = diff(range(PKB, na.rm = TRUE)),
    Skośność_PKB = skewness(PKB, na.rm = TRUE),
    Kurtosis_PKB = kurtosis(PKB, na.rm = TRUE),
    
    # Statystyki dla Roku
    Średnia_Rok = mean(Rok, na.rm = TRUE),
    Mediana_Rok = median(Rok, na.rm = TRUE),
    Odchylenie_standardowe_Rok = sd(Rok, na.rm = TRUE),
    Min_Rok = min(Rok, na.rm = TRUE),
    Max_Rok = max(Rok, na.rm = TRUE),
    Kwartyla_1_Rok = quantile(Rok, 0.25, na.rm = TRUE),
    Kwartyla_3_Rok = quantile(Rok, 0.75, na.rm = TRUE),
    IQR_Rok = IQR(Rok, na.rm = TRUE),
    Skala_Rok = diff(range(Rok, na.rm = TRUE)),
    Skośność_Rok = skewness(Rok, na.rm = TRUE),
    Kurtosis_Rok = kurtosis(Rok, na.rm = TRUE),
    
    # Statystyki dla Gini
    Średnia_G = mean(G, na.rm = TRUE),
    Mediana_G = median(G, na.rm = TRUE),
    Odchylenie_standardowe_G = sd(G, na.rm = TRUE),
    Min_G = min(G, na.rm = TRUE),
    Max_G = max(G, na.rm = TRUE),
    Kwartyla_1_G = quantile(G, 0.25, na.rm = TRUE),
    Kwartyla_3_G = quantile(G, 0.75, na.rm = TRUE),
    IQR_G = IQR(G, na.rm = TRUE),
    Skala_G = diff(range(G, na.rm = TRUE)),
    Skośność_G = skewness(G, na.rm = TRUE),
    Kurtosis_G = kurtosis(G, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = everything(), 
               names_to = c("Statystyka", "Zmienna"), 
               names_pattern = "(.*)_(.*)", 
               values_to = "Wartość") %>%
  pivot_wider(names_from = "Zmienna", values_from = "Wartość") %>%
  mutate(across(c(PKB, Rok, G), ~ label_number(accuracy = 1)(.)))

# Wyświetlenie wyników w formie tabeli
print(statystyki_all)

```

# Analiza danych

## Jaka jest zależność między położeniem geograficznym w Europie, a wysokością PKB i wzrostem gospodarczym państw na przestrzeni lat?


Może te akapity będą odpowiedziami na poszczególne pytania badawcze?

-   Dla cech kategorycznych: Analiza rozkładu, testy chi-kwadrat, kontyngencje.

-   Dla cech ciągłych: Analiza korelacji, testy t-studenta, regresja liniowa.

Interpretacja wyników - Opisać wyniki analizy, odnosząc się do postawionych wcześniej pytań badawczych. Logicznie przedstawić wyniki, które prowadzą do odpowiedzi na pytania badawcze.


W poniższyj analizie będziemy starały odpowiedzieć czy instnieje zależność między położeniem geograficznym w Europie, a wysokością PKB i wzrostem gospodarczym państw na przestrzeni lat.

```{r, echo=FALSE, massage=FALSE}
# Filtracja danych dla roku 2000
data_2000 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  
  filter(Rok == 2000) %>%
  arrange(PKB) %>%            # Sortowanie według PKB (rosnąco)
  slice_head(n = 15)          # Wybór 15 krajów o najniższym PKB

# Tworzenie wykresu
library(ggplot2)

ggplot(data_2000, aes(x = reorder(Kraj, PKB), y = PKB, fill = Region)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "15 krajów w Europie z najniższym PKB w 2000 roku",
    x = "Kraj",
    y = "PKB"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1", name = "Region") +  # Kolory dla regionów
  scale_y_continuous(labels = scales::label_number(accuracy = 1)) +
  theme(
    legend.position = "bottom"  # Przeniesienie legendy na dół
  )




```

Na wykresie widnieje 15 krajów z najniższym PKB w roku 2000. Możemy zaobserwować przewagę państw z Europy Wschodniej, które zostały oznaczone kolorem czerwonym oraz z Europy Południowej oznaczone kolorem zielonym. Ukraina, Mołdawia, Białoruś znajdują się w Europie Wschodniej, a ich PKB jest najniższe z całej Europy.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Filtracja danych dla roku 2000
data_2000 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  # Usunięcie duplikatów
  filter(Rok == 2000) %>%
  arrange(desc(PKB)) %>%           # Sortowanie według PKB (malejąco)
  slice_head(n = 15)               # Wybór 15 krajów z najwyższym PKB

# Tworzenie wykresu
ggplot(data_2000, aes(x = reorder(Kraj, PKB), y = PKB, fill = Region)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "15 krajów w Europie z najwyższym PKB w 2000 roku",
    x = "Kraj",
    y = "PKB"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1", name = "Region") +  # Kolory dla regionów
  scale_y_continuous(labels = scales::label_number(accuracy = 1)) +
  theme(
    legend.position = "bottom"  # Przeniesienie legendy na dół
  )

```

Aż siedem krajów z Europy Wschodniej występuję w rankingu piętnastu krajów w Europie z najwyższym PKB w 2000 roku. Luksemburg jest państwem z najwyższym PKB. Jest ono prawie dwa razy większe od PKB Szwajcarji, które zjamuje drugie miejsce w rankingu. Kraje Europy Północnej (np. Norwegia, Dania, Szwecja, Irlandia) również osiągnęły wysokie PKB,

```{r, echo=FALSE, massage=FALSE}
# Filtracja danych dla roku 2020
data_2020 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  
  filter(Rok == 2020) %>%
  arrange(PKB) %>%            # Sortowanie według PKB (rosnąco)
  slice_head(n = 15)          # Wybór 15 krajów o najniższym PKB

# Tworzenie wykresu
library(ggplot2)


ggplot(data_2020, aes(x = reorder(Kraj, PKB), y = PKB, fill = Region)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "15 krajów w Europie z najniższym PKB w 2020 roku",
    x = "Kraj",
    y = "PKB"
  ) +
  theme_minimal() +

  scale_fill_brewer(palette = "Set1", name = "Region") +  # Kolory dla regionów
  scale_y_continuous(labels = scales::label_number(accuracy = 1)) +
  theme(
    legend.position = "bottom"  # Przeniesienie legendy na dół
  )


```
W 2020 roku na czele listy krajów z najniższym PKB znalazły się kraje Południowej takie jak Macedonia Północna i Serbia. W porównaniu z rokiem 2000 wystepuję dużo więcej państw z Europy Południowj. Kraje Europy Wschodniej, takie jak Bułgaria, Rosja, Rumunia, wciąż dominują w zestawieniu najniższego PKB, ale zauważalny jest wzrost ich gospodarek w porównaniu do roku 2000.

  scale_fill_gradient(low = "lightblue", high = "darkblue",labels = scales::label_number(accuracy = 1))

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Filtracja danych dla roku 2000
data_2020 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  # Usunięcie duplikatów
  filter(Rok == 2020) %>%
  arrange(desc(PKB)) %>%           # Sortowanie według PKB (malejąco)
  slice_head(n = 15)               # Wybór 15 krajów z najwyższym PKB

# Tworzenie wykresu
ggplot(data_2020, aes(x = reorder(Kraj, PKB), y = PKB, fill = Region)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "15 krajów w Europie z najwyższym PKB w 2020 roku",
    x = "Kraj",
    y = "PKB"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1", name = "Region") +  # Kolory dla regionów
  scale_y_continuous(labels = scales::label_number(accuracy = 1)) +
  theme(
    legend.position = "bottom"  # Przeniesienie legendy na dół
  )
```

W 2020 roku najwyższe PKB nadal posiada Luksemburg co nie zmieniło sie w przeciągu 20 lat. Jednak róznica pomiędzy Luksemburgiem, a np. Iralndią nie jest już tak znaczna. Wciąż występuję dominajcja regionów północnych i zachodnich.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Filtracja danych dla krajów
rich_countries <- c("Luxembourg", "Ireland", "Switzerland", "Norway", "Netherlands", "Denmark", "Austria")
poor_countries <- c("Moldova", "Ukraine", "Belarus", "Bulgaria","North Macedonia", "Russia","Latvia")

# Dane dla bogatych krajów
data_rich <- data %>%
  filter(Kraj %in% rich_countries) %>%
  group_by(Kraj, Rok) %>%
  summarise(PKB_avg = mean(PKB, na.rm = TRUE), .groups = "drop")

# Dane dla biednych krajów
data_poor <- data %>%
  filter(Kraj %in% poor_countries) %>%
  group_by(Kraj, Rok) %>%
  summarise(PKB_avg = mean(PKB, na.rm = TRUE), .groups = "drop")

# Wykres dla bogatych krajów
plot_rich <- ggplot(data_rich, aes(x = Rok, y = PKB_avg, color = Kraj)) +
  geom_line(size = 1) +
  labs(
    title = "PKB w krajach z najwyższym PKB na przestrzeni lat",
    x = "Rok",
    y = "PKB"
  ) +
  theme_minimal()

# Wykres dla biednych krajów
plot_poor <- ggplot(data_poor, aes(x = Rok, y = PKB_avg, color = Kraj)) +
  geom_line(size = 1) +
  labs(
    title = "PKB w krajach z najniższym PKB na przestrzeni lat",
    x = "Rok",
    y = "PKB"
  ) +
  theme_minimal()

# Wyświetlenie wykresów obok siebie
library(patchwork)
plot_rich 
plot_poor
```

Luksemburg i Irlandia odnotowały najszybszy wzrost PKB, szczególnie po 2000 roku. Irlandia osiągnęła gwałtowny wzrost ostatnich dwudziestu latach. Dania, Norwegia, Szwajcaria, Austria, i Holandia charakteryzują się stabilnym, ale mniej dynamicznym wzrostem w porównaniu do Irlandii i Luksemburga. W latach 2008-2009 widoczny jest spadek PKB w większości krajów, co jest efektem globalnego kryzysu finansowego.

Dla krajów takich jak Rosja, Ukraina, Białoruś, Mołdawia czy Łotwa można zaobserwować znaczny spadek PKB w latach 90., co jest związane z rozpadem Związku Radzieckiego. Po roku 2000 widoczny jest wyraźny wzrost PKB we wszystkich analizowanych krajach, co wskazuje na poprawę sytuacji gospodarczej po trudnym okresie transformacji lat 90.



```{r, echo=FALSE, warning=FALSE, message=FALSE}
data_region_year <- data %>%
  group_by(Region, Rok) %>%
  summarise(mean_PKB = mean(PKB), .groups = "drop")  # Średni PKB dla każdego roku i regionu

# Tworzenie wykresu regresji
ggplot(data_region_year, aes(x = Rok, y = mean_PKB, color = Region)) +
  geom_point(size = 2) +  # Punkty danych
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, size = 1) +  # Linie regresji
  labs(
    title = "Regresja liniowa PKB w Europie w zależności od regionu od 1958 do 2022",
    x = "Rok",
    y = "Wartość PKB"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

Na wykresie zaobserwujemy zróżnicowany poziom PKB między regionami.Wszystkie regiony Europy wykazują wzrost PKB w analizowanym okresie, jednak region zachodni i północny rozwiją się najprężniej. Europa Zachodnia (Western Europe) odznacza się najwyższym poziomem PKB w całym okresie. Europa Wschodnia (Eastern Europe) ma najniższy poziom PKB, co wynika z opóźnienia w rozwoju gospodarczym w porównaniu z resztą regionów.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Obliczenie średniego PKB dla każdego regionu
avg_pkb_region <- data %>%
  filter(Rok == 2000,Region %in% c("Southern Europe", "Western Europe", "Eastern Europe", "Northern Europe")) %>%
  group_by(Region) %>%
  summarise(Średni_PKB = mean(PKB, na.rm = TRUE)) %>%
  arrange(desc(Średni_PKB))  # Sortowanie w porządku malejącym

# Tworzenie wykresu słupkowego
ggplot(avg_pkb_region, aes(x = reorder(Region, Średni_PKB), y = Średni_PKB, fill = Region)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Średnia wartość PKB w regionach Europy w 2000",
    x = "Region",
    y = "PKB",
    fill = "Region"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Średnia wartość PKB w roku 2000 znacznie rózniła sie między regionami.Europa Zachodnia miała najwyższe średnie PKB spośród wszystkich, za to Europa Wschodnia zanotowała njaniższe.Europa Północna zajmowała drugie miejsce pod względem wielkości PKB, a tuż za nią Europa Południowa.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Obliczenie średniego PKB dla każdego regionu
avg_pkb_region <- data %>%
  filter(Rok == 2020,Region %in% c("Southern Europe", "Western Europe", "Eastern Europe", "Northern Europe")) %>%
  group_by(Region) %>%
  summarise(Średni_PKB = mean(PKB, na.rm = TRUE)) %>%
  arrange(desc(Średni_PKB))  # Sortowanie w porządku malejącym

# Tworzenie wykresu słupkowego
ggplot(avg_pkb_region, aes(x = reorder(Region, Średni_PKB), y = Średni_PKB, fill = Region)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Średnia wartość PKB w regionach Europy w 2020",
    x = "Region",
    y = "PKB",
    fill = "Region"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

W 2020 roku Europa Zachodnia i Północna pozostają liderami gospodarczymi. Rozwój gospodarczy Europy Wschodniej poskutkował zmniejszaniem się  dysproporcji pomiędzy Europy Południowej. Pomimo postępu, różnice w poziomie PKB wciąż są widoczne choć mniejsze w porównaniu z 2000 rokiem.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
data_2020 <- data %>%
  filter(Rok == 2000)
  
# Wykres boxplot porównujący PKB w różnych regionach w 2020 roku
ggplot(data_2020, aes(x = Region, y = PKB, fill = Region)) +
  geom_boxplot() +
  labs(
    title = "Wykres pudełkowy rozkładu PKB w regionach Europy w 2000 roku",
    x = "Region",
    y = "PKB"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```

Region Europy Zachodniej posiada największą medianę. Następnie Europa Północna, Europa Południowa, Europa Wschodnia. Rozstępy międzykwartylowe wskazują na większe zróżnicowanie wewnątrz Europy Południowej, podczas gdy Europa Wschodnia i Północna są bardziej jednorodne. Wartości odstające w Europie Zachodniej i Północnej pokazują wyjątkowo wysokie PKB w niektórych krajach, podczas gdy w Europie Wschodniej i Południowej odnotowano odstające wartości na dolnym poziomie.


to chyba usune
```{r, echo=FALSE, warning=FALSE, message=FALSE}

library(ggsignif)# 1. Grupowanie danych i obliczanie średniego PKB dla regionów
data_region_year <- data %>%
  group_by(Region, Rok) %>%
  summarise(mean_PKB = mean(PKB), .groups = "drop")  # Średni PKB dla każdego roku i regionu

# 2. Testy t-Studenta dla porównań między regionami

# Pobranie unikalnych regionów
regions <- unique(data$Region)

# Przygotowanie wyników testów t-Studenta dla wszystkich par regionów
results <- expand.grid(Region1 = regions, Region2 = regions) %>%
  filter(Region1 != Region2) %>%
  rowwise() %>%
  mutate(
    t_test = list(t.test(
      data %>% filter(Region == Region1) %>% pull(PKB),
      data %>% filter(Region == Region2) %>% pull(PKB),
      alternative = "two.sided",
      var.equal = FALSE
    )),
    p_value = t_test$p.value,
    statistic = t_test$statistic
  )

# Dodanie korekty Bonferroniego dla wielokrotnych porównań
results <- results %>%
  mutate(p_adjusted = p.adjust(p_value, method = "bonferroni"))

# 3. Wizualizacja - Wykres pudełkowy z oznaczeniem wyników testów t-Studenta

ggplot(data, aes(x = Region, y = PKB, fill = Region)) +
  geom_boxplot() +
  geom_signif(
    comparisons = list(c("Eastern Europe", "Western Europe"), c("Southern Europe", "Northern Europe")),  # Przykłady regionów
    map_signif_level = TRUE
  ) +
  labs(
    title = "Rozkład PKB w różnych regionach Europy",
    x = "Region",
    y = "PKB per capita"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

ggplot(data_region_year, aes(x = Region, y = mean_PKB, fill = Region)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
   
  labs(
    title = "Średnia wartość PKB per capita w regionach Europy",
    x = "Region",
    y = "Średnia wartość PKB"
  ) +
  theme_minimal()


# 5. Wyświetlenie tabeli wyników testów t-Studenta
results %>%
  select(Region1, Region2, p_value, p_adjusted) %>%
  arrange(p_value)

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
data_2020 <- data %>%
  filter(Rok == 2020)

# Wykres boxplot porównujący PKB w różnych regionach w 2020 roku
ggplot(data_2020, aes(x = Region, y = PKB, fill = Region)) +
  geom_boxplot() +
  labs(
    title = "Wykres pudełkowy rozkładu PKB w regionach Europy w 2020 roku",
    x = "Region",
    y = "PKB"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```

Wszystkie regiony Europy odnotowały wzrost mediany PKB w 2020 roku w porównaniu do 2000 roku. Ranking wielkości median pozostaje niezmienny. Rozstępy międzykwartylowe sugerują, że największe różnice w PKB występują w Europie Południowej, a najmniejsze w Europie Wschodniej.Wartości odstające w Europie Zachodniej i Północnej potwierdzają istnienie liderów gospodarczych w tych regionach, podczas gdy w Europie Wschodniej wskazują na kraje zmagające się z trudnościami gospodarczymi.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Krok 1: Wczytanie danych geograficznych krajów z rnaturalearth
world <- ne_countries(scale = 50, returnclass = 'sf')

# Krok 3: Lista krajów do wyświetlenia (bez Rosji)
countries_to_show <- c("Albania", "Austria", "Belarus", "Belgium", "Bulgaria", 
                       "Croatia", "Czechia", "Denmark", "Estonia", 
                       "Finland", "France", "Germany", "Greece", "Hungary", "Iceland", 
                       "Ireland", "Italy", "Latvia", "Lithuania", "Luxembourg", "Malta", 
                       "Moldova", "Montenegro", "Netherlands", "North Macedonia", 
                       "Norway", "Poland", "Portugal", "Romania", "Serbia", "Russia",
                       "Serbia and Montenegro", "Slovakia", "Slovenia", "Soviet Union", 
                       "Spain", "Sweden", "Switzerland", "Ukraine", "United Kingdom")

# Krok 4: Filtruj dane, aby tylko wybrane kraje były w zbiorze i dla roku 2000
data_filtered <- data %>%
  filter(Kraj %in% countries_to_show) %>%
  filter(Rok == 2000)  # Filtruj dane na rok 2000

# Krok 5: Połącz dane geograficzne z danymi o krajach
world_filtered <- world %>%
  filter(name %in% countries_to_show) %>%
  left_join(data_filtered, by = c("name" = "Kraj"))

# Krok 6: Rysowanie mapy (bez etykiet i bez Rosji)
ggplot(world_filtered) + 
  geom_sf(aes(fill = PKB), color = 'black') +  # Kolorowanie krajów na podstawie PKB
  coord_sf(crs = st_crs(3035),                   # Ustawienie układu współrzędnych
           xlim = c(2000000, 6200000), 
           ylim = c(1500000, 5500000)) +         # Zakres widocznej części mapy
    scale_fill_viridis_c(option = "C", na.value = 'white') +
    scale_fill_viridis_c(option = "C", na.value = 'white', # Kolor biały dla brakujących danych
                        name = "Wartość PKB",    # Tytuł legendy
                        labels = scales::label_comma()) + # Skala kolorów  # Skala kolorów
  theme_minimal() +  # Minimalistyczny wygląd
  labs(title = "Mapa PKB w krajach Europy w 2000 roku") +
  theme(axis.text = element_blank(),   # Usunięcie napisów osi
        axis.ticks = element_blank(),  # Usunięcie ticków osi
        axis.title = element_blank())  # Usunięcie tytułów osi

```
Mapa PKB z 2000 roku zróżnicowanie gospodarcze w Europie w 2000 roku było wyraźnie widoczne między bogatą Europą Zachodnią i Północną, umiarkowanie rozwiniętą Europą Południową oraz rozwijającą się Europą Wschodnią.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Ładowanie niezbędnych bibliotek
library(rnaturalearth)
library(sf)
library(dplyr)
library(ggplot2)
library(readr)
library(stringr)

# Krok 1: Wczytanie danych geograficznych krajów z rnaturalearth
world <- ne_countries(scale = 50, returnclass = 'sf')

# Krok 3: Lista krajów do wyświetlenia (bez Rosji)
countries_to_show <- c("Albania", "Austria", "Belarus", "Belgium", "Bulgaria", 
                       "Croatia", "Czechia", "Denmark", "Estonia", 
                       "Finland", "France", "Germany", "Greece", "Hungary", "Iceland", 
                       "Ireland", "Italy", "Latvia", "Lithuania", "Luxembourg", "Malta", 
                       "Moldova", "Montenegro", "Netherlands", "North Macedonia", 
                       "Norway", "Poland", "Portugal", "Romania", "Serbia", "Russia",
                       "Serbia and Montenegro", "Slovakia", "Slovenia", "Soviet Union", 
                       "Spain", "Sweden", "Switzerland", "Ukraine", "United Kingdom")

# Krok 4: Filtruj dane, aby tylko wybrane kraje były w zbiorze i dla roku 2000
data_filtered <- data %>%
  filter(Kraj %in% countries_to_show) %>%
  filter(Rok == 2020)  # Filtruj dane na rok 2000

# Krok 5: Połącz dane geograficzne z danymi o krajach
world_filtered <- world %>%
  filter(name %in% countries_to_show) %>%
  left_join(data_filtered, by = c("name" = "Kraj"))

# Krok 6: Rysowanie mapy (bez etykiet i bez Rosji)
ggplot(world_filtered) + 
  geom_sf(aes(fill = PKB), color = 'black') +  # Kolorowanie krajów na podstawie PKB
  coord_sf(crs = st_crs(3035),                   # Ustawienie układu współrzędnych
           xlim = c(2000000, 6200000), 
           ylim = c(1500000, 5500000)) +         # Zakres widocznej części mapy
  scale_fill_viridis_c(option = "C", na.value = 'white') +
    scale_fill_viridis_c(option = "C", na.value = 'white', # Kolor biały dla brakujących danych
                        name = "Wartość PKB",    # Tytuł legendy
                        labels = scales::label_comma()) + # Skala kolorów
  theme_minimal() +  # Minimalistyczny wygląd
  labs(title = "Mapa PKB w krajach Europy w 2020 roku",
       subtitle = "PKB") +
  theme(axis.text = element_blank(),   # Usunięcie napisów osi
        axis.ticks = element_blank(),  # Usunięcie ticków osi
        axis.title = element_blank())  # Usunięcie tytułów osi
```
Mapa PKB w krajach Europy w 2020 roku ukazuje istotne zróżnicowanie gospodarcze między regionami. Europa Zachodnia i Północna utrzymały najwyższe wartości PKB, wskazując na stabilny rozwój. Europa Południowa odnotowała umiarkowany wzros, a Europa Wschodnia zanotowała największy względny wzrost, choć poziom PKB nadal pozostaje najniższy. W porównaniu do 2000 roku we wszystkich regionach widoczny jest wyraźny wzrost gospodarczy, szczególnie w Europie Wschodniej.

## Czy dołączenie do Unii Europejskiej miało wpływ na zmianę PKB państw członkowskich?

-   Zestaw dane krajów UE z krajami, które nie przystąpiły do Unii (np. Norwegia, Szwajcaria, kraje Bałkanów Zachodnich). Zastosuj technikę różnic w różnicach (Difference-in-Differences), aby porównać zmiany PKB między krajami UE i kontrolną grupą państw spoza UE.

Unia Europejska powstała 1 listopada 1993 roku. Od lat odgrywa ona kluczową rolę w rozwoju państw członkowskich. W niniejszym sprawozdaniu zajmiemy się czterema rozszerzeniami Unii Europejskiej, z lat 1995, 2004, 2007 i 2013. Zbadamy czy w obrębie 10 lat od przystąpienia do Unii Europejskiej dane państwa na tym skorzystały - w sensie miary rozwoju gospodarczego, jakim jest produkt krajowy brutto.

### Rok 1995 - dołączenie do UE Austrii, Szwecji i Finlandii

1.  Porównanie wartości PKB ze średnią unii

Zaczniemy analizę od spojrzenia na wykres wartości PKB przez 10 lat przed dołączeniem do Unii Europejskiej i 10 lat po dołączeniu.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(broom)
# Obliczanie średniego PKB UE w latach 1985-2005
data_avg_95 <- data %>%
  filter(Rok >= 1985, Rok <= 2005, 
        Kraj %in% c("Belgium", "France", "Netherlands", "Luxembourg", "Germany", "Italy", "Greece", "Spain", "Portugal")) %>%
  group_by(Rok) %>%
  summarise(średnie_PKB_UE = mean(PKB, na.rm = TRUE))

# Przygotowanie danych na konkretne państwa w latach 1985-2005
data_ue_95 <- data %>%
  filter(Kraj %in% c("Austria", "Finland", "Sweden"), 
         Rok >= 1985, Rok <= 2005) %>%
  mutate(
    Okres = case_when(
      Rok <= 1995 ~ "Przed 1995 rokiem",
      Rok > 1995 ~ "Po 1995 roku"
    ),
    Kraj = recode(
      Kraj, 
      "Austria" = "Austria", 
      "Finland" = "Finlandia", 
      "Sweden" = "Szwecja")
  )

# Wykres
ggplot(data_ue_95, aes(x = Rok, y = PKB, color = Kraj, linetype = Okres)) +  
  geom_line(
    data = data_avg_95, 
    aes(x = Rok, y = średnie_PKB_UE, color = "Średnia PKB w UE"), 
    size = 0.7, 
    linetype = "dashed"
    ) +
  geom_point() +
  #geom_line() +
  #geom_smooth(method = "lm", se = TRUE) + #regresja liniowa
  scale_color_manual(
    values = c(
      "Austria" = "orange",
      "Finlandia" = "purple",
      "Szwecja" = "green",
      "Średnia PKB w UE" = "blue"
    ),
     breaks = c("Austria", "Finlandia", "Szwecja", "Średnia PKB w UE"),
    name = "Kraj / Linia"
  ) +
  labs(
    title = "Porównanie PKB w latach 1985 - 2005",
    x = "Rok",
    y = "PKB (USD per capita)",
    color = "Kraj",
    linetype = "Okres"
  ) +
  theme_minimal() +
  scale_x_continuous(
    limits = c(1985, 2005),
    breaks = seq(1985, 2005, 2),
    labels = function(x) format(x, digits = 4)
  ) +
  scale_linetype_manual(
    values = c("Przed UE" = "dashed", "Po UE" = "longdash") # Własne typy linii
  ) +
  geom_vline(xintercept = 1995, linetype = "dotdash", color = "black") +  
  theme(axis.text.x = element_text(size = 8))
```

Widocznym jest, że akcesja sprawiła przybliżenie PKB Finlandii, Szwecji i Austrii do średniej PKB Unii.

#### Średnie tempo wzrostu PKB

Zbadajmy średnie tempo wzrostu produktu krajowego brutto przed integracją z Unią Europejską jak i po niej.

```{r, echo=FALSE, warning=FALSE, message=FALSE}

# Obliczanie różnicy rocznego PKB
tempo_pkb_95 <- data_ue_95 %>%
  filter(Kraj %in% c("Austria", "Finlandia", "Szwecja"),
         (Kraj == "Austria" & Rok >= 1994 & Rok <= 2005) | 
         (Kraj != "Austria" & Rok >= 1985 & Rok <= 2005)) %>%
  group_by(Kraj, Okres) %>%
  arrange(Rok) %>%
  mutate(
    roczna_zmiana_pkb = (PKB - lag(PKB)) / lag(PKB)  # Obliczanie rocznej zmiany PKB
  ) %>%
  filter(!is.na(roczna_zmiana_pkb)) %>%
  # Obliczanie średniego tempa wzrostu oraz odchylenia standardowego w jednym etapie
  summarize(
    średnie_tempo = mean(roczna_zmiana_pkb, na.rm = TRUE) * 100,  # Średnie tempo wzrostu
    sd_tempo = sd(roczna_zmiana_pkb, na.rm = TRUE),  # Odchylenie standardowe
    .groups = 'drop'
  ) %>%
  rename(
    "Średnie tempo wzrostu w %" = średnie_tempo,
    "STD wzrostu rocznego" = sd_tempo
  )

# Zobacz wynik
print(tempo_pkb_95)

```

Z tabeli możemy odczytać, że w Finlandii oraz Szwecji średnie tempo wzrostu po wstąpieniu do Unii Europejskiej się zwiększyło, odpowiednio o około 0,41 oraz 0,38 punktów procentowych, natomiast dla Austrii to tempo zmniejszyło się o 0,23 punkty procentowe.

\*Uwaga\*: W tym przypadku dla Austrii policzone zostały wartości dla lat 1994-2005, by uniknąć błędów wynikających z braków danych. Przez to średnie roczne tempo wzrostu na lata 1985-1995 może różnić się od rzeczywistego.

Odchylenie standardowe tempa wzrostu będzie wskazywało na stabilność wzrostu. Dla wszystkich trzech państw rozproszenie wartości wokół średniej jest niskie. Tylko dla Finlandii po 1995 roku odchylenie standardowe zmalało, co może sugerować stabilniejszą gospodarkę, bardziej przewidywalne roczne zmiany PKB, mniej narażone na wahania.

#### Analiza t-testu

W poniższej tabeli znajdują się wyniki t-testu porównania średnich PKB przed i po 1995 roku na poziomie ufności 95%.

```{r}
library(dplyr)  # Jeśli tylko dplyr
# lub
library(tidyverse)  # Jeśli używasz całego zestawu tidyverse
library(broom)  # Ładowanie pakietu broom

# t-test porównania średnich PKB przed i po 1995 roku
t_test_95 <- data_ue_95 %>%
  group_by(Kraj) %>%
  do(tidy(t.test(PKB ~ Okres, data = .))) %>%
  select(Kraj, estimate, p.value, conf.low, conf.high) %>%
  rename(
    "Różnica średnich" = estimate, 
    "p-wartość" = p.value, 
    "Dolna gr" = conf.low, 
    "Górna gr" = conf.high)

print(t_test_95)

```

Różnica średnich w każdym przypadku jest dodatnia i znajduje się w swoim przedziale ufności, zatem po wejściu w struktury UE nastąpił wzrost produktów krajowych brutto dla badanych państw. Bardzo małe p-wartości wskazują, że jest to statystycznie istotny wzrost.

#### Wnioski

Po analizie dostępnych danych, można stwierdzić, że rozpoczęcie członkostwa w Unii Europejskiej w 1995 roku było dobrą decyzją dla gospodarek Szwecji, Austrii oraz Finlandii.

### Rok 2004 - wybrane: Polska, Litwa, Słowenia, Węgry

#### Porównanie wartości PKB ze średnią unii

komentarz

```{r, echo=FALSE, warning=FALSE, message=FALSE}

# Obliczanie średniego PKB UE w latach 1994-2014
data_avg_04 <- data %>%
  filter(Rok >= 1994, Rok <= 2014, 
        Kraj %in% c("Belgium", "France", "Netherlands", "Luxembourg", "Germany", "Italy", "Greece", "Spain", "Portugal", "Austria", "Finland", "Sweden")) %>%
  group_by(Rok) %>%
  summarise(średnie_PKB_UE_04 = mean(PKB, na.rm = TRUE))

# Przygotowanie danych na konkretne państwa w latach 1985-2005
data_ue_04 <- data %>%
  filter(Kraj %in% c("Poland", "Lithuania", "Slovenia", "Hungary"), 
         Rok >= 1994, Rok <= 2014) %>%
  mutate(
    Okres = case_when(
      Rok <= 2004 ~ "Przed 2004 rokiem",
      Rok > 2004 ~ "Po 2004 roku"
    ),
    Kraj = recode(
      Kraj, 
      "Poland" = "Polska",
      "Lithuania" = "Litwa", 
      "Slovenia" = "Słowenia", 
      "Hungary" = "Węgry")
  )

# Wykres
ggplot(data_ue_04, aes(x = Rok, y = PKB, color = Kraj, linetype = Okres)) +  
  geom_line(
    data = data_avg_04, 
    aes(x = Rok, y = średnie_PKB_UE_04, color = "Średnia PKB w UE"), 
    size = 0.7, 
    linetype = "dashed"
    ) +
  geom_point() +
  #geom_line() +
  #geom_smooth(method = "lm", se = TRUE) + #regresja liniowa
  scale_color_manual(
    values = c(
      "Słowenia" = "orange",
      "Węgry" = "purple",
      "Litwa" = "green",
      "Polska" = "red",
      "Średnia PKB w UE" = "blue"
    ),
     breaks = c("Średnia PKB w UE", "Słowenia", "Węgry", "Litwa", "Polska"),
    name = "Kraj / Linia"
  ) +
  labs(
    title = "Porównanie PKB w latach 1994 - 2014",
    x = "Rok",
    y = "PKB (USD per capita)",
    color = "Kraj",
    linetype = "Okres"
  ) +
  theme_minimal() +
  scale_x_continuous(
    limits = c(1994, 2014),
    breaks = seq(1994, 2014, 2),
    labels = function(x) format(x, digits = 4)
  ) +
  geom_vline(xintercept = 2004, linetype = "dotdash", color = "black") +  
  theme(axis.text.x = element_text(size = 8))
```

komentarz

#### Średnie tempo wzrostu PKB

Zbadajmy średnie tempo wzrostu produktu krajowego brutto przed integracją z Unią Europejską jak i po niej.

```{r, echo=FALSE, warning=FALSE, message=FALSE}

# Obliczanie różnicy rocznego PKB
tempo_pkb_04 <- data_ue_04 %>%
  group_by(Kraj, Okres) %>%
  arrange(Rok) %>%
  mutate(
    roczna_zmiana_pkb = (PKB - lag(PKB)) / lag(PKB)  # Obliczanie rocznej zmiany PKB
  ) %>%
  filter(!is.na(roczna_zmiana_pkb)) %>%
  # Obliczanie średniego tempa wzrostu oraz odchylenia standardowego w jednym etapie
  summarize(
    średnie_tempo = mean(roczna_zmiana_pkb, na.rm = TRUE) * 100,  # Średnie tempo wzrostu
    sd_tempo = sd(roczna_zmiana_pkb, na.rm = TRUE),  # Odchylenie standardowe
    .groups = 'drop'
  ) %>%
  rename(
    "Średnie tempo wzrostu w %" = średnie_tempo,
    "STD wzrostu rocznego" = sd_tempo
  )

# Zobacz wynik
print(tempo_pkb_04)

```

KOmentarz

#### Analiza t-testu

W poniższej tabeli znajdują się wyniki t-testu porównania średnich PKB przed i po 2004 roku na poziomie ufności 95%.

```{r}

# t-test porównania średnich PKB przed i po 
t_test_04 <- data_ue_04 %>%
  group_by(Kraj) %>%
  do(tidy(t.test(PKB ~ Okres, data = .))) %>%
  select(Kraj, estimate, p.value, conf.low, conf.high) %>%
  rename(
    "Różnica średnich" = estimate, 
    "p-wartość" = p.value, 
    "Dolna gr" = conf.low, 
    "Górna gr" = conf.high)

print(t_test_04)

```

komentarz

#### Wnioski

komentarz

### Rok 2007 - dołączenie do UE Bułgarii i Rumunii

#### Porównanie wartości PKB ze średnią unii

\[do zmiany\] Zaczniemy analizę od spojrzenia na wykres wartości PKB przez 10 lat przed dołączeniem do Unii Europejskiej i 10 lat po dołączeniu.

```{r, echo=FALSE, warning=FALSE, message=FALSE}

# Obliczanie średniego PKB UE w latach 1997-2017
data_avg_07 <- data %>%
  filter(Rok >= 1997, Rok <= 2017, UE == "EU" & !(Kraj %in% c("Croatia", "Romania", "Bulgaria"))) %>%
  group_by(Rok) %>%
  summarise(średnie_PKB_UE_07 = mean(PKB, na.rm = TRUE))

# Przygotowanie danych dla Rumunii i Bułgarii
data_ue_07 <- data %>%
  filter(Kraj %in% c("Romania", "Bulgaria"), Rok >= 1997, Rok <= 2017) %>%
  mutate(
    Okres = case_when(
      Rok <= 2007 ~ "Przed 2007 rokiem",
      Rok > 2007 ~ "Po 2007 roku"
    ),
    Kraj = recode(Kraj, "Romania" = "Rumunia", "Bulgaria" = "Bułgaria"))

# Wykres
ggplot(data_ue_07, aes(x = Rok, y = PKB, color = Kraj, linetype = Okres)) +
  geom_line(
    data = data_avg_07, 
    aes(x = Rok, y = średnie_PKB_UE_07, color = "Średnia PKB w UE"), 
    size = 0.7, 
    linetype = "dashed"
    ) +
  geom_point() +
  geom_line(aes(x = Rok, y = PKB, color = Kraj, linetype = Okres) +
  scale_color_manual(
    values = c(
      "Rumunia" = "red",
      "Bułgaria" = "green", 
      "Średnia PKB w UE" = "blue"
    ), 
    breaks = c("Rumunia", "Bułgaria", "Średnia PKB w UE"),name = "Kraj / Linia"),
    name = "Kraj / Linia"
  ) +
  labs(
    title = "Porównanie PKB w latach 1997 - 2007",
    x = "Rok",
    y = "PKB (USD per capita)",
    color = "Kraj",
    linetype = "Okres"
  ) +
  theme_minimal() +
  scale_x_continuous(
    limits = c(1997, 2017),
    breaks = seq(1997, 2017, 2),
    labels = function(x) format(x, digits = 4)
  ) +
  geom_vline(xintercept = 2007, linetype = "dotdash", color = "black") +  
  theme(axis.text.x = element_text(size = 8))
```

komentarz

#### Średnie tempo wzrostu PKB

\[do zmiany\] Zbadajmy średnie tempo wzrostu produktu krajowego brutto przed integracją z Unią Europejską jak i po niej.

```{r, echo=FALSE, warning=FALSE, message=FALSE}

# Obliczanie różnicy rocznego PKB
tempo_pkb_07 <- data_ue_07 %>%
  group_by(Kraj, Okres) %>%
  arrange(Rok) %>%
  mutate(roczna_zmiana_pkb = (PKB - lag(PKB)) / lag(PKB)) %>%
  filter(!is.na(roczna_zmiana_pkb)) %>%
  # Obliczanie średniego tempa wzrostu oraz odchylenia standardowego w jednym etapie
  summarize(
    średnie_tempo = mean(roczna_zmiana_pkb, na.rm = TRUE) * 100,  # Średnie tempo wzrostu
    sd_tempo = sd(roczna_zmiana_pkb, na.rm = TRUE),  # Odchylenie standardowe
    .groups = 'drop'
  ) %>%
  rename(
    "Średnie tempo wzrostu w %" = średnie_tempo,
    "STD wzrostu rocznego" = sd_tempo
  )

# Zobacz wynik
print(tempo_pkb_07)

```

komentarz

#### Analiza t-testu

W poniższej tabeli znajdują się wyniki t-testu porównania średnich PKB przed i po 1995 roku na poziomie ufności 95%.

```{r}
library(dplyr)  # Jeśli tylko dplyr
# lub
library(tidyverse)  # Jeśli używasz całego zestawu tidyverse
library(broom)  # Ładowanie pakietu broom

# t-test porównania średnich PKB przed i po 1995 roku
t_test_07 <- data_ue_07 %>%
  group_by(Kraj) %>%
  do(tidy(t.test(PKB ~ Okres, data = .))) %>%
  select(Kraj, estimate, p.value, conf.low, conf.high) %>%
  rename(
    "Różnica średnich" = estimate, 
    "p-wartość" = p.value, 
    "Dolna gr" = conf.low, 
    "Górna gr" = conf.high)

print(t_test_07)

```

Różnica średnich w każdym przypadku jest dodatnia i znajduje się w swoim przedziale ufności, zatem po wejściu w struktury UE nastąpił wzrost produktów krajowych brutto dla badanych państw. Bardzo małe p-wartości wskazują, że jest to statystycznie istotny wzrost.

#### Wnioski

Po analizie dostępnych danych, można stwierdzić, że rozpoczęcie członkostwa w Unii Europejskiej w 1995 roku było dobrą decyzją dla gospodarek Szwecji, Austrii oraz Finlandii. \## Jak duże są nierówności dochodowe między państwami w Europie?

Zbadanie współczynnika nierówności dochodowej w Europie.

## Wnioski

Na końcu tej sekcji przedstaw wnioski związane z odpowiedziami na pytania badawcze, np. "Z analizy wynika, że istnieje silna korelacja między PKB a poziomem nierówności dochodowych."

# Podsumowanie

Przypomnienie najważniejszych wniosków z analizy.

# Dyskusja

Myślę, że to bardzo fajny dodatkowy akapit, który warto uwzględnić na lepsze punkciki :)

-   **Ograniczenia**: Omówienie wszelkiech ograniczeń analizy, np. problem z jakością danych, brakującymi wartościami, czy ograniczonym zakresem badanych zmiennych.

    -   Dane PKB powinny być porównane z inflacją, bezrobociem itp. w 2 pytaniu przydałyby się informacje o wielkości funduszy UE, ale nie mieliśmy dostępu do takich danych, więc taka analiza nie jest do końca zgodna z prawdą(efektywna?)
    -   Integracja gospodarcza, wspólny rynek i stabilność polityczno-gospodarcza mogły pozytywnie wpłynąć. Dla głebszej analizy warto wziąć pod uwagę inne czynniki, takie jak globalne trendy gospodarcze, struktura gospodarek, reformy wewnętrzne czy wpływy kryzysów.

-   **Propozycje przyszłych badań**: Zasugerowanie, co można by zbadać w przyszłości, aby poszerzyć lub pogłębić wyniki.
