---
title: "Sprawozdanie na temat nierówności dochodów w Europie."
author: 
  - name: "Karolina Bakalarz"
    index: "276059"
  - name: "Amelia Bieda"
    index: "275973"
format: pdf
editor: visual
lang: pl
---

# Wstęp

## Cel sprawozdania

Celem niniejszego sprawozdania jest analiza trzech kluczowych zagadnień związanych z poziomem zamożności i nierówności dochodowych w Europie.

Przede wszystkim, badanie ma na celu zrozumienie, w jaki sposób położenie geograficzne krajów w Europie wpływa na ich poziom zamożności, mierzony poprzez PKB.

Zbadamy również wpływ przynależności do Unii Europejskiej na gospodarki krajów, z naciskiem na ewentualne zmiany w poziomie PKB po akcesji do UE.

Ostatecznie sprawdzimy nierówności dochodowe między poszczególnymi państwami europejskimi, poprzez wyniki wskaźnika Gini'ego.

Taka analiza pozwoli nam lepiej zrozumieć sytuację ekonomiczną w Europie, w kontekście zamożności i rozwoju gospodarczego.

## Źródło danych

Dane wykorzystane w analizie pochodzą z najnowszej wersji World Income Inequality Database (WIID), opublikowanej 28 listopada 2023 roku. WIID to największe dostępne źródło danych o nierównościach dochodowych na świecie, udostępniane bezpłatnie na otwartej licencji.

Źródła danych obejmują raporty krajowe i regionalne publikowane przez instytucje statystyczne i rządowe, międzynarodowe bazy danych, takie jak Światowy Bank, OECD i Eurostat, oraz ankiety i badania gospodarstw domowych dotyczące dochodów, konsumpcji i nierówności.

Wszystkie dane są standaryzowane, aby umożliwić porównania między krajami i okresami, co pozwala WIID dostarczać spójne serie czasowe, wskaźniki nierówności oraz pełne rozkłady dochodów na poziomie krajowym i globalnym.

# Opis danych

-   Kraj - określa, do którego europejskiego państwa przynależą dane w badanym wierszu.

-   Skrót - trzycyfrowy kod kraju w formacie ISO 3166-1.

-   G - wskaźnik Giniego, czyli miara koncentracji rozkładu zmiennej losowej, w tym przypadku nierówności dochodowej, określona na przedziale 0-100 (w procentach). Wartość zerowa wspołczynnika wskazuje na pełną równomierność rozkładu.

-   Zasoby - szczegółowy podział zasobów

    -   IDK CZY TO UWZGLĘDNIMY, to narazie bardziej dla nas, w oryginalnych danych mamy podział: "Consumption", "Income, net", "Income, net/gross", "Earnings, gross", "Income, gross", "Market income", "Taxable income, gross", "Taxable income, net", "Earnings, net", "Monetary income, net", "Monetary income, gross", "Factor income", "Monetary income, net (excluding property income)", "Earnings", "Taxable income, excluding property income", "Taxable income, gross (including deductions)".

-   Skala - szczegółowa skala normalizacji(?). ?przeskalowane dochody?

    -   "Per capita", "OECD-modified", "Equivalized", "No adjustment", "Square root", "OECD", NA, "National scale", "1977 McClements scale".

-   Region - grupowanie subregionalne, czyli podział na Europę północną, południową, zachodnią i wschodnią (oparte na geoschemacie Organizacji Narodów Zjednoczonych).

-   G - wskaźnik Giniego, czyli miara koncentracji rozkładu zmiennej losowej, w tym przypadku nierówności dochodowej.

-   UE - status należenia do Unii Europejskiej dla odpowiedniego roku.

-   PKB - wartość produktu krajowego brutto (w dolarach amerykańskich?).

## Wczytanie i przygotowanie danych

-   nadanie odpowiednich nazw zmiennych,

-   zadbanie o odpowiednie typy kolumn,

-   czyszczenie wartości, jeśli zachodzi taka konieczność,

-   dyskusję lub obsługę braków danych;

Z bazy danych WIID będziemy w niniejszym raporcie skupiać się na analizie danych z Europy. Z tego powodu, pozostawiłyśmy wartości dotyczące jedynie analizowanego przez nas kontynentu. Zweryfikowałyśmy typy danych dla każdej kolumny, następnie, dla lepszej czytelności, nazwy kolumn zostały zmienione. Wiersze z brakami danych ("NA") usunęłyśmy, aby uniknąć nieciągłości. W krajach rozwiniętych dane o dochodach są powszechniej stosowane w badaniach, niż dane o wydatkach konsumpcyjnych, stąd zdecydowałyśmy się usunąć zmienną "Consumption" w kategorii "Zasoby".

Po przygotowaniu otrzymałyśmy zbiór około 13 tysięcy wartości w 9 kolumnach. Prezentuje się on następująco:



```{r, echo=FALSE, massage=FALSE}
#| echo: false
#| warning: false
library(tidyverse)

data <- read_csv2("dane_WIID_2023.csv", show_col_types = FALSE) %>%
  filter(region_un == "Europe") %>%
  select(country, c3, year, gini, resource_detailed, scale_detailed, region_un_sub, eu, gdp) %>%
  mutate(across(c(country, c3, resource_detailed, scale_detailed, region_un_sub, eu), as.factor)) %>%
  mutate(across(c(year, gini), as.numeric)) %>%
  filter(resource_detailed != "Consumption") %>%
  filter(if_all(everything(), ~ !is.na(.))) %>%
  filter(scale_detailed == "Per capita") %>%
   mutate(
    gdp = str_remove_all(gdp, " "), # Remove spaces from PKB (gdp)
    gdp = as.numeric(gdp)          # Convert PKB (gdp) to numeric
  ) %>%
  rename(
    Kraj = country,
    Skrót = c3,
    Rok = year,
    G = gini,
    Zasoby = resource_detailed,
    Skala = scale_detailed,
    Region = region_un_sub,
    UE = eu,
    PKB = gdp
  )

```

```{r, echo=FALSE, massage=FALSE}
head(data) 
unique(data$Kraj)
library(dplyr)

# Zliczanie liczby wystąpień dla każdego roku
najczestszy_rok <- data %>%
  count(Rok) %>%                 # Zliczanie wystąpień dla każdej wartości w kolumnie Rok
  arrange(desc(n)) %>%           # Sortowanie według liczby wystąpień (malejąco)
  slice_head(n = 30)              # Wybranie wiersza z najczęstszym rokiem

print(najczestszy_rok)

```

# Analiza danych

## Akapit

1\. Czy jest zależność między położeniem geograficznym w Europie a zamożnością?

Może te akapity będą odpowiedziami na poszczególne pytania badawcze?

-   Dla cech kategorycznych: Analiza rozkładu, testy chi-kwadrat, kontyngencje.

-   Dla cech ciągłych: Analiza korelacji, testy t-studenta, regresja liniowa.

Interpretacja wyników - Opisać wyniki analizy, odnosząc się do postawionych wcześniej pytań badawczych. Logicznie przedstawić wyniki, które prowadzą do odpowiedzi na pytania badawcze.

```{r, echo=FALSE, massage=FALSE}
# Filtracja danych dla roku 2000
data_2000 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  
  filter(Rok == 2000) %>%
  arrange(PKB) %>%            # Sortowanie według PKB (rosnąco)
  slice_head(n = 15)          # Wybór 15 krajów o najniższym PKB

# Tworzenie wykresu
library(ggplot2)

ggplot(data_2000, aes(x = reorder(Kraj, PKB), y = PKB, fill = PKB)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "The 15 Countries with Lowest GDP in Europe in 2000",
    x = "Country",
    y = "GDP (Per Capita)"
  ) +
  theme_minimal() +
  scale_fill_gradient(low = "lightblue", high = "darkblue",labels = scales::label_number(accuracy = 1))




```
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Filtracja danych dla roku 2000
data_2000 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  # Usunięcie duplikatów
  filter(Rok == 2000) %>%
  arrange(desc(PKB)) %>%           # Sortowanie według PKB (malejąco)
  slice_head(n = 15)               # Wybór 15 krajów z najwyższym PKB

# Tworzenie wykresu
ggplot(data_2000, aes(x = reorder(Kraj, PKB), y = PKB, fill = PKB)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "The 15 Countries with Highest GDP in Europe in 2000",
    x = "Country",
    y = "GDP (Per Capita)"
  ) +
  theme_minimal() +
  scale_fill_gradient(
    low = "lightblue", 
    high = "darkblue",
    name = "GDP (in USD)",
    labels = scales::label_number(accuracy = 1)   # Formatowanie wartości w legendzie
  )

```

```{r, echo=FALSE, massage=FALSE}
# Filtracja danych dla roku 2020
data_2020 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  
  filter(Rok == 2020) %>%
  arrange(PKB) %>%            # Sortowanie według PKB (rosnąco)
  slice_head(n = 15)          # Wybór 15 krajów o najniższym PKB

# Tworzenie wykresu
library(ggplot2)

ggplot(data_2020, aes(x = reorder(Kraj, PKB), y = PKB, fill = PKB)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "The 15 Countries with Lowest GDP in Europe in 2020",
    x = "Country",
    y = "GDP (Per Capita)"
  ) +
  theme_minimal() +
  scale_fill_gradient(low = "lightblue", high = "darkblue",labels = scales::label_number(accuracy = 1))




```
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Filtracja danych dla roku 2000
data_2020 <- data %>%
  distinct(Kraj, PKB, .keep_all = TRUE) %>%  # Usunięcie duplikatów
  filter(Rok == 2020) %>%
  arrange(desc(PKB)) %>%           # Sortowanie według PKB (malejąco)
  slice_head(n = 15)               # Wybór 15 krajów z najwyższym PKB

# Tworzenie wykresu
ggplot(data_2020, aes(x = reorder(Kraj, PKB), y = PKB, fill = PKB)) +
  geom_bar(stat = "identity", color = "black") +
  coord_flip() +
  labs(
    title = "The 15 Countries with Highest GDP in Europe in 2000",
    x = "Country",
    y = "GDP (Per Capita)"
  ) +
  theme_minimal() +
  scale_fill_gradient(
    low = "lightblue", 
    high = "darkblue",
    name = "GDP (in USD)",
    labels = scales::label_number(accuracy = 1)   # Formatowanie wartości w legendzie
  )

```


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Ładowanie niezbędnych bibliotek
library(rnaturalearth)
library(sf)
library(dplyr)
library(ggplot2)
library(readr)
library(stringr)

# Krok 1: Wczytanie danych geograficznych krajów z rnaturalearth
world <- ne_countries(scale = 50, returnclass = 'sf')

# Krok 3: Lista krajów do wyświetlenia (bez Rosji)
countries_to_show <- c("Albania", "Austria", "Belarus", "Belgium", "Bulgaria", 
                       "Croatia", "Czechia", "Denmark", "Estonia", 
                       "Finland", "France", "Germany", "Greece", "Hungary", "Iceland", 
                       "Ireland", "Italy", "Latvia", "Lithuania", "Luxembourg", "Malta", 
                       "Moldova", "Montenegro", "Netherlands", "North Macedonia", 
                       "Norway", "Poland", "Portugal", "Romania", "Serbia", "Russia",
                       "Serbia and Montenegro", "Slovakia", "Slovenia", "Soviet Union", 
                       "Spain", "Sweden", "Switzerland", "Ukraine", "United Kingdom")

# Krok 4: Filtruj dane, aby tylko wybrane kraje były w zbiorze i dla roku 2000
data_filtered <- data %>%
  filter(Kraj %in% countries_to_show) %>%
  filter(Rok == 2020)  # Filtruj dane na rok 2000

# Krok 5: Połącz dane geograficzne z danymi o krajach
world_filtered <- world %>%
  filter(name %in% countries_to_show) %>%
  left_join(data_filtered, by = c("name" = "Kraj"))

# Krok 6: Rysowanie mapy (bez etykiet i bez Rosji)
ggplot(world_filtered) + 
  geom_sf(aes(fill = PKB), color = 'black') +  # Kolorowanie krajów na podstawie PKB
  coord_sf(crs = st_crs(3035),                   # Ustawienie układu współrzędnych
           xlim = c(2000000, 6200000), 
           ylim = c(1500000, 5500000)) +         # Zakres widocznej części mapy
  scale_fill_viridis_c(option = "C", na.value = 'white') +  # Skala kolorów
  theme_minimal() +  # Minimalistyczny wygląd
  labs(title = "Mapa PKB na świecie (Wybrane kraje, rok 2020)",
       subtitle = "PKB per capita w 2020 roku") +
  theme(axis.text = element_blank(),   # Usunięcie napisów osi
        axis.ticks = element_blank(),  # Usunięcie ticków osi
        axis.title = element_blank())  # Usunięcie tytułów osi

yes


```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Ładowanie niezbędnych bibliotek
library(rnaturalearth)
library(sf)
library(dplyr)
library(ggplot2)
library(readr)
library(stringr)

# Krok 1: Wczytanie danych geograficznych krajów z rnaturalearth
world <- ne_countries(scale = 50, returnclass = 'sf')

# Krok 3: Lista krajów do wyświetlenia (bez Rosji)
countries_to_show <- c("Albania", "Austria", "Belarus", "Belgium", "Bulgaria", 
                       "Croatia", "Czechia", "Denmark", "Estonia", 
                       "Finland", "France", "Germany", "Greece", "Hungary", "Iceland", 
                       "Ireland", "Italy", "Latvia", "Lithuania", "Luxembourg", "Malta", 
                       "Moldova", "Montenegro", "Netherlands", "North Macedonia", 
                       "Norway", "Poland", "Portugal", "Romania", "Serbia", "Russia",
                       "Serbia and Montenegro", "Slovakia", "Slovenia", "Soviet Union", 
                       "Spain", "Sweden", "Switzerland", "Ukraine", "United Kingdom")

# Krok 4: Filtruj dane, aby tylko wybrane kraje były w zbiorze i dla roku 2000
data_filtered <- data %>%
  filter(Kraj %in% countries_to_show) %>%
  filter(Rok == 2000)  # Filtruj dane na rok 2000

# Krok 5: Połącz dane geograficzne z danymi o krajach
world_filtered <- world %>%
  filter(name %in% countries_to_show) %>%
  left_join(data_filtered, by = c("name" = "Kraj"))

# Krok 6: Rysowanie mapy (bez etykiet i bez Rosji)
ggplot(world_filtered) + 
  geom_sf(aes(fill = PKB), color = 'black') +  # Kolorowanie krajów na podstawie PKB
  coord_sf(crs = st_crs(3035),                   # Ustawienie układu współrzędnych
           xlim = c(2000000, 6200000), 
           ylim = c(1500000, 5500000)) +         # Zakres widocznej części mapy
  scale_fill_viridis_c(option = "C", na.value = 'white') +  # Skala kolorów
  theme_minimal() +  # Minimalistyczny wygląd
  labs(title = "Mapa PKB na świecie (Wybrane kraje, rok 2000)",
       subtitle = "PKB per capita w 2000 roku") +
  theme(axis.text = element_blank(),   # Usunięcie napisów osi
        axis.ticks = element_blank(),  # Usunięcie ticków osi
        axis.title = element_blank())  # Usunięcie tytułów osi

yes

```
## Akapit

2\. Czy dołączenie do UE miało wpływ na zmianę GDP?



## Akapit

3\. Zbadanie współczynnika nierówności dochodowej w Europie.

## Wnioski

Na końcu tej sekcji przedstaw wnioski związane z odpowiedziami na pytania badawcze, np. "Z analizy wynika, że istnieje silna korelacja między PKB a poziomem nierówności dochodowych."

# Podsumowanie

Przypomnienie najważniejszych wniosków z analizy.

# Dyskusja

Myślę, że to bardzo fajny dodatkowy akapit, który warto uwzględnić na lepsze punkciki :)

-   **Ograniczenia**: Omówienie wszelkiech ograniczeń analizy, np. problem z jakością danych, brakującymi wartościami, czy ograniczonym zakresem badanych zmiennych.

-   **Propozycje przyszłych badań**: Zasugerowanie, co można by zbadać w przyszłości, aby poszerzyć lub pogłębić wyniki.
